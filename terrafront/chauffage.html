<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js">
    </script>
    <script>

      function changetext() {
          if (document.getElementById('touteAnnee').checked) {
              $.ajax({
                  url: "http://localhost:8080/terrarium/chauffage/UpdateTouteLannee",
                  data: {
                      max: document.getElementById('max').value,
                      min: document.getElementById('min').value
                  },
                  async: false,
                  type: 'get',      //请求方式
                  dataType: "json",  //返回数据的格式
                  contentType: "application/json; charset=utf-8",
                  error: function () {
                      alert('加载数据失败！');
                  },
                  success: function (data) {
                      var item = data;
                      //console.log(item);
                      for (var i = 0; i < item.length; i++) {
                          console.log(item[i]);
                      }
                      result = data; // 接收返回值
                      alert(JSON.stringify(result.data))
                  }
              });

          } else {
              $.ajax({
                  url: "http://localhost:8080/terrarium/chauffage/UpdateAll",
                  data:  JSON.stringify([{
                      moisDebut:document.getElementById('mois_debut').value,
                      moisFin:document.getElementById('mois_fin').value,
                      heureDebut:document.getElementById('heure_debut').value,
                      heureFin:document.getElementById('heure_fin').value,
                      max: document.getElementById('max').value,
                      min: document.getElementById('min').value,

                  }]),
                  async: false,
                  type: 'post',      //请求方式
                  dataType: "json",  //返回数据的格式
                  contentType: "application/json; charset=utf-8",
                  error: function () {
                      alert('加载数据失败！');
                  },
                  success: function (data) {
                      var item = data;
                      //console.log(item);
                      for (var i = 0; i < item.length; i++) {
                          console.log(item[i]);
                      }
                      result = data; // 接收返回值
                      alert(JSON.stringify(result.data))
                  }
              });


          }
      }


    </script>

</head>
<body>
<h1>CHAUFFAGE</h1>
<div><div>isProgrammable : <div/><div id="isProg"> vide </div><button onclick="prog()">Changer la facon de controler le chauffage</button></div>
    <div><div>etat de chauffage : </div><div id="etat"> vide </div><button onclick="etat()" id="btn_etat">Changer l'etat de chauffage manuellement</button></div>
<div>  <input type="checkbox" name="touteAnnee" id="touteAnnee" value="touteAnnee"> toute l'annee<br>
    <p>mois debut: <input type="text" name="mois_debut" id="mois_debut" /></p>
    <p>mois fin: <input type="text" name="mois_fin" id="mois_fin"/></p>
    <p>heure debut: <input type="text" name="heure_debut" id="heure_debut"/></p>
    <p>heure fin: <input type="text" name="heure_fin" id="heure_fin"/></p>
    <p>max: <input type="text" name="max" id="max"/></p>
    <p>min: <input type="text" name="min" id="min"/></p>
    <button onclick="changetext()">Configure le chauffage</button></div>

</body>

<script>
    $("#touteAnnee").change(function() {
        if(this.checked) {
            document.getElementById("mois_debut").setAttribute("disabled","disabled");
            document.getElementById("mois_fin").setAttribute("disabled","disabled");
            document.getElementById("heure_fin").setAttribute("disabled","disabled");
            document.getElementById("heure_debut").setAttribute("disabled","disabled");
        }
        else{  document.getElementById("mois_debut").removeAttribute("disabled");
            document.getElementById("mois_fin").removeAttribute("disabled");
            document.getElementById("heure_fin").removeAttribute("disabled");
            document.getElementById("heure_debut").removeAttribute("disabled");


        }
    });
    $.ajax({
        url: "http://localhost:8080/terrarium/chauffage/getEtatChauffage",
        async: false,
        type: 'get',      //请求方式
        dataType: "json",  //返回数据的格式
        contentType: "application/json; charset=utf-8",
        error: function () {
            alert('加载数据失败！');
        },
        success: function (data) {
            var item = data;
            //console.log(item);
            for (var i = 0; i < item.length; i++) {
                console.log(item[i]);
            }
            result = data; // 接收返回值
            document.getElementById("isProg").innerHTML = result.data.prog;
            document.getElementById("etat").innerHTML = result.data.etat;
            if(document.getElementById("isProg").innerHTML=="true"){
                document.getElementById("btn_etat").style.display="none";
            }
            else if(document.getElementById("isProg").innerHTML=="false"){
                document.getElementById("btn_etat").style.display="";
            }
        }
    });
    function prog() {
        var isProg;
        if( document.getElementById("isProg").innerHTML=="true"){

            isProg="false";


        } else if (document.getElementById("isProg").innerHTML == "false") {

            isProg = "true";
        }

        $.ajax({
            url: "http://localhost:8080/terrarium/chauffage/changeControleInterrupteur",
            data: {
                isProg: isProg
            },
            async: false,
            type: 'get',      //请求方式
            dataType: "json",  //返回数据的格式
            contentType: "application/json; charset=utf-8",
            error: function () {
                alert('加载数据失败！');
            },
            success: function (data) {

                var item = data;
                //console.log(item);
                for (var i = 0; i < item.length; i++) {
                    console.log(item[i]);
                }
                result = data; // 接收返回值
                // alert(JSON.stringify(result.data))
                document.getElementById("isProg").innerHTML = result.data.prog;
                if(document.getElementById("isProg").innerHTML=="true"){
                    document.getElementById("btn_etat").style.display="none";
                }
               else if(document.getElementById("isProg").innerHTML=="false"){
                    document.getElementById("btn_etat").style.display="";
                }
            }
        });

    }

    function etat() {
        var etat;
        if( document.getElementById("etat").innerHTML=="true"){

            etat="false";


        }
        else if(document.getElementById("etat").innerHTML=="false"){

            etat="true";
        }

        $.ajax({
            url: "http://localhost:8080/terrarium/chauffage/changeEtatInterrupteurManuellement",
            data:  {
                etat:etat
            },
            async: false,
            type: 'get',      //请求方式
            dataType: "json",  //返回数据的格式
            contentType: "application/json; charset=utf-8",
            error: function () {
                alert('加载数据失败！');
            },
            success: function (data) {

                var item = data;
                //console.log(item);
                for (var i = 0; i < item.length; i++) {
                    console.log(item[i]);
                }
                result = data; // 接收返回值
                // alert(JSON.stringify(result.data))
                document.getElementById("etat").innerHTML = result.data.etat;
            }
        });

    }
</script>
</html>
